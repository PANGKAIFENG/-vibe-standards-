# /contribute-spec - 贡献规范到 vibe-standards

帮助你将新规范贡献到 vibe-standards 仓库。此命令调用 **spec-contributor** 代理来评估规范的通用性、检查重复性、决定分类，并协助提交到 GitHub。

## 使用方法

```bash
/contribute-spec [file-path | description]
```

## 参数

- `file-path`: 规范文档的路径（支持 .md 文件）
- `description`: 直接描述规范内容

## 何时使用

- 团队发现需要新增规范时
- 项目中沉淀了通用的最佳实践时
- 想要将项目规范贡献到公共仓库时
- 不确定规范是否应该提交到 vibe-standards 时

## 工作流程

执行此命令时，`spec-contributor` 代理将：

### Phase 1: 文档读取

1. 如果提供了文件路径，读取并解析文档
2. 如果是描述，提取规范的核心要素
3. 识别规范的主要内容和目的

### Phase 2: 通用性评估

检查以下通用性指标：

| 指标 | 通用 | 项目特定 |
|------|------|---------|
| 颜色值 | 使用语义色（如 danger, success）| 使用具体色值（如 #FF6B00）|
| 组件名 | 通用组件（按钮、弹窗、表单）| 业务组件（任务卡片、看板）|
| 域名 | 无或使用变量（$domain）| 具体域名（aitimemg.cn）|
| 流程 | 通用流程（确认删除、表单验证）| 业务流程（发布到特定平台）|

生成通用性评分（0-100）：

| 评分 | 判定 | 说明 |
|------|------|------|
| 90-100 | 高度通用 | 可直接贡献 |
| 70-89 | 需改造 | 抽象后可贡献 |
| 50-69 | 边界情况 | 需讨论 |
| 0-49 | 项目特定 | 不应贡献 |

### Phase 3: 重复性检查

搜索现有规范：
- `rules/*.md` - 全局规则
- `skills/*/SKILL.md` - 技能包
- `agents/*.md` - 代理定义
- `commands/*.md` - 命令定义

如果发现类似规范，建议合并或更新而非新建。

### Phase 4: 分类决策

根据规范特征决定放置位置：

```
始终生效的原则/约束 → rules/
被动触发的知识库 → skills/
主动调用的专家角色 → agents/
用户触发的快捷方式 → commands/
```

### Phase 5: 改造建议（如需要）

如果规范包含项目特定内容，提供改造建议：
- 参数化具体值（如将 #FF6B00 标记为示例）
- 泛化特定概念（如"任务卡片"→"数据卡片"）
- 分离通用和特定部分
- 添加"自定义指南"章节

### Phase 6: 提交流程

确认后执行：
1. 创建 `feat/add-[spec-name]-spec` 分支
2. 写入规范文件
3. 更新 README.md
4. 创建 PR 并附上评估报告

## 示例

### 示例 1: 高度通用的规范

```bash
/contribute-spec ./docs/button-state-spec.md
```

输出:
```
📋 规范贡献评估报告

✅ 通用性评分: 92/100 (高度通用)
✅ 重复性检查: 未发现类似规范
📁 建议分类: rules/
📝 建议文件名: 03-component-state-spec.md

是否继续提交到 GitHub？[Y/n]
```

### 示例 2: 项目特定规范

```bash
/contribute-spec ./docs/release-workflow.md
```

输出:
```
📋 规范贡献评估报告

⚠️ 通用性评分: 45/100 (项目特定)
❌ 检测到项目特定内容:
   - 域名: aitimemg.cn
   - OSS 部署路径
   - 特定的 npm run deploy 命令

📝 建议: 此规范应保留在项目的 .claude/ 目录中，
   而非贡献到 vibe-standards。

如需提取通用部分，可运行:
/contribute-spec --extract-generic ./docs/release-workflow.md
```

### 示例 3: 需要改造的规范

```bash
/contribute-spec ./docs/ui-spec.md
```

输出:
```
📋 规范贡献评估报告

🔧 通用性评分: 75/100 (需改造)
✅ 重复性检查: 发现相似规范 rules/02-design-ui-spec.md

📝 建议: 合并到现有规范

需要改造的内容:
1. 将 #3B82F6 → 标记为"示例颜色"
2. 将 "Inter" → 标记为"示例字体"
3. 添加"自定义指南"章节

是否显示改造后的版本？[Y/n]
```

## 选项

| 选项 | 说明 |
|------|------|
| `--dry-run` | 只评估不提交 |
| `--extract-generic` | 提取通用部分 |
| `--force` | 跳过确认直接提交（谨慎使用）|
| `--target [dir]` | 指定目标目录 |

## 输出报告格式

```markdown
# 规范贡献评估报告

## 基本信息
- **规范名称**: [名称]
- **来源文档**: [路径]
- **评估时间**: [日期]

## 通用性评估
- **评分**: [0-100]
- **判定**: [高度通用 / 需改造 / 边界情况 / 项目特定]
- **理由**: [详细说明]

## 重复性检查
- **是否存在类似规范**: [是/否]
- **相似规范**: [列表]

## 分类建议
- **建议目录**: [rules / skills / agents / commands]
- **建议文件名**: [文件名]

## 改造建议（如需要）
- **需要抽象的内容**: [列表]

## 下一步
- [ ] 确认评估结果
- [ ] 执行改造（如需要）
- [ ] 提交到 GitHub
```

## 相关

- `spec-contributor` 代理 - 核心处理逻辑
- `/learn` 命令 - 从会话中提取模式
- `/update-docs` 命令 - 更新文档
- `guides/how-to-use.md` - 团队协作指南
